# دليل استخدام نقاط النهاية (Endpoints) في المشروع

## مقدمة

هذا المشروع هو نظام لإدارة الصالات الرياضية (Gym Management System) يحتوي على مجموعة من نقاط النهاية (Endpoints) التي تتيح للمستخدمين التفاعل مع النظام. يمكن استخدام هذه النقاط لإنشاء، قراءة، تحديث، وحذف البيانات المتعلقة بالمستخدمين، الفروع، المعدات، الاشتراكات، وغيرها.

---

## كيفية استخدام نقاط النهاية

### 1. المصادقة (Authentication)

#### تسجيل الدخول

- **الوصف**: تسجيل الدخول باستخدام بيانات المستخدم.

- **الطريقة**: POST

- **الرابط**: `/auth/login`

- **البيانات المطلوبة**:

  ```json
  {
    "email": "example@example.com",
    "password": "password123"
  }
  ```

- **الاستجابة**:

  ```json
  {
    "token": "jwt-token"
  }
  ```

#### تسجيل الخروج

- **الوصف**: تسجيل الخروج من النظام.

- **الطريقة**: POST

- **الرابط**: `/auth/logout`

---

### 2. المستخدمون (Users)

#### إنشاء مستخدم جديد

- **الوصف**: إنشاء حساب مستخدم جديد.

- **الطريقة**: POST

- **الرابط**: `/users`

- **البيانات المطلوبة**:

  ```json
  {
    "name": "John Doe",
    "email": "john@example.com",
    "password": "password123"
  }
  ```

#### الحصول على قائمة المستخدمين

- **الوصف**: استرجاع جميع المستخدمين.

- **الطريقة**: GET

- **الرابط**: `/users`

---

### 3. الفروع (Branches)

#### إنشاء فرع جديد

- **الوصف**: إضافة فرع جديد للصالة الرياضية.

- **الطريقة**: POST

- **الرابط**: `/branches`

- **البيانات المطلوبة**:

  ```json
  {
    "name": "Main Branch",
    "location": "Downtown"
  }
  ```

#### الحصول على قائمة الفروع

- **الوصف**: استرجاع جميع الفروع.

- **الطريقة**: GET

- **الرابط**: `/branches`

---

### 4. المعدات (Equipment)

#### إضافة معدات جديدة

- **الوصف**: إضافة معدات جديدة للصالة الرياضية.

- **الطريقة**: POST

- **الرابط**: `/equipment`

- **البيانات المطلوبة**:

  ```json
  {
    "name": "Treadmill",
    "quantity": 5
  }
  ```

#### الحصول على قائمة المعدات

- **الوصف**: استرجاع جميع المعدات.

- **الطريقة**: GET

- **الرابط**: `/equipment`

---

### 5. الاشتراكات (Memberships)

#### إنشاء خطة اشتراك جديدة

- **الوصف**: إضافة خطة اشتراك جديدة.

- **الطريقة**: POST

- **الرابط**: `/membership-plans`

- **البيانات المطلوبة**:

  ```json
  {
    "name": "Gold Plan",
    "price": 100
  }
  ```

#### الحصول على قائمة خطط الاشتراك

- **الوصف**: استرجاع جميع خطط الاشتراك.

- **الطريقة**: GET

- **الرابط**: `/membership-plans`

---

### 6. الجلسات المجدولة (Scheduled Sessions)

#### إنشاء جلسة جديدة

- **الوصف**: إضافة جلسة تدريبية جديدة.

- **الطريقة**: POST

- **الرابط**: `/scheduled-sessions`

- **البيانات المطلوبة**:

  ```json
  {
    "type": "Yoga",
    "date": "2025-06-25",
    "time": "10:00 AM"
  }
  ```

#### الحصول على قائمة الجلسات

- **الوصف**: استرجاع جميع الجلسات المجدولة.

- **الطريقة**: GET

- **الرابط**: `/scheduled-sessions`

---

## وصف الملفات في المشروع

### 1. المجلد `src`

#### المجلد `controllers`

- يحتوي على الملفات التي تعالج الطلبات الواردة من المستخدمين وتحدد كيفية التعامل معها.
  - `authController.js`: مسؤول عن عمليات تسجيل الدخول والخروج.
  - `bookingController.js`: مسؤول عن إدارة الحجوزات.
  - `branchController.js`: مسؤول عن إدارة الفروع.
  - `equipmentController.js`: مسؤول عن إدارة المعدات.
  - `gymController.js`: مسؤول عن إدارة بيانات الصالة الرياضية.
  - `membershipPlanController.js`: مسؤول عن إدارة خطط الاشتراك.
  - `memberSubscriptionController.js`: مسؤول عن إدارة اشتراكات الأعضاء.
  - `scheduledSessionController.js`: مسؤول عن إدارة الجلسات المجدولة.
  - `trainingClassTypeController.js`: مسؤول عن إدارة أنواع الفصول التدريبية.
  - `userController.js`: مسؤول عن إدارة بيانات المستخدمين.

#### المجلد `middlewares`

- يحتوي على ملفات الوسائط التي تُستخدم لمعالجة الطلبات قبل وصولها إلى وحدات التحكم.
  - `authMiddleware.js`: مسؤول عن التحقق من صلاحيات المستخدم.

#### المجلد `models`

- يحتوي على تعريفات النماذج (Models) المستخدمة في قاعدة البيانات.
  - `booking.js`: نموذج للحجوزات.
  - `branch.js`: نموذج للفروع.
  - `branchstaffassignment.js`: نموذج لتعيينات الموظفين في الفروع.
  - `equipment.js`: نموذج للمعدات.
  - `gym.js`: نموذج للصالة الرياضية.
  - `membershipplan.js`: نموذج لخطط الاشتراك.
  - `membersubscription.js`: نموذج لاشتراكات الأعضاء.
  - `scheduledsession.js`: نموذج للجلسات المجدولة.
  - `sessionenrollment.js`: نموذج لتسجيل الجلسات.
  - `trainingclasstype.js`: نموذج لأنواع الفصول التدريبية.
  - `user.js`: نموذج للمستخدمين.

#### المجلد `routes`

- يحتوي على تعريفات المسارات (Routes) التي تربط الطلبات بوحدات التحكم.
  - `authRoutes.js`: مسارات المصادقة.
  - `bookingRoutes.js`: مسارات الحجوزات.
  - `branchRoutes.js`: مسارات الفروع.
  - `equipmentRoutes.js`: مسارات المعدات.
  - `gymRoutes.js`: مسارات الصالة الرياضية.
  - `membershipPlanRoutes.js`: مسارات خطط الاشتراك.
  - `memberSubscriptionRoutes.js`: مسارات اشتراكات الأعضاء.
  - `scheduledSessionRoutes.js`: مسارات الجلسات المجدولة.
  - `trainingClassTypeRoutes.js`: مسارات أنواع الفصول التدريبية.
  - `userRoutes.js`: مسارات المستخدمين.

#### المجلد `services`

- يحتوي على الخدمات (Services) التي تحتوي على منطق الأعمال.
  - `bookingService.js`: خدمة إدارة الحجوزات.
  - `branchService.js`: خدمة إدارة الفروع.
  - `equipmentService.js`: خدمة إدارة المعدات.
  - `gymService.js`: خدمة إدارة بيانات الصالة الرياضية.
  - `membershipPlanService.js`: خدمة إدارة خطط الاشتراك.
  - `memberSubscriptionService.js`: خدمة إدارة اشتراكات الأعضاء.
  - `scheduledSessionService.js`: خدمة إدارة الجلسات المجدولة.
  - `trainingClassTypeService.js`: خدمة إدارة أنواع الفصول التدريبية.
  - `userService.js`: خدمة إدارة بيانات المستخدمين.

#### الملف `server.js`

- الملف الرئيسي لتشغيل الخادم.

### 2. المجلد `migrations`

- يحتوي على ملفات الهجرة (Migrations) التي تُستخدم لإنشاء وتحديث جداول قاعدة البيانات.

### 3. المجلد `seeders`

- يحتوي على ملفات التهيئة (Seeders) التي تُستخدم لإضافة بيانات افتراضية إلى قاعدة البيانات.

### 4. الملفات الأخرى

- `package.json`: يحتوي على معلومات المشروع وقائمة الحزم المستخدمة.
- `config.json`: يحتوي على إعدادات قاعدة البيانات.
- `README_AR.md`: دليل استخدام المشروع باللغة العربية.

---

## كيفية تشغيل المشروع واستخدامه

### 1. إعداد البيئة

1. **تثبيت المتطلبات**:
   - تأكد من تثبيت Node.js وnpm على جهازك.
   - قم بتثبيت قاعدة البيانات (مثل MySQL أو PostgreSQL) وقم بإعدادها.

2. **تثبيت الحزم**:
   - افتح سطر الأوامر وانتقل إلى مجلد المشروع.
   - قم بتشغيل الأمر التالي لتثبيت الحزم المطلوبة:

     ```bash
     npm install
     ```

3. **إعداد قاعدة البيانات**:
   - قم بتحديث ملف `config/config.json` بمعلومات الاتصال بقاعدة البيانات.
   - قم بتشغيل أوامر الهجرة لإنشاء الجداول:

     ```bash
     npx sequelize db:migrate
     ```

   - (اختياري) قم بتشغيل أوامر التهيئة لإضافة بيانات افتراضية:

     ```bash
     npx sequelize db:seed:all
     ```

### 2. تشغيل الخادم

- لتشغيل الخادم، قم بتشغيل الأمر التالي:

  ```bash
  npm start
  ```

- سيتم تشغيل الخادم على العنوان الافتراضي `http://localhost:3000`.

### 3. اختبار نقاط النهاية

- يمكنك استخدام أدوات مثل Postman أو cURL لاختبار نقاط النهاية.
- تأكد من إرسال رمز المصادقة (JWT Token) في ترويسة الطلبات (Headers) عند الحاجة.

#### مثال على اختبار نقطة نهاية باستخدام cURL

- **تسجيل الدخول**:

  ```bash
  curl -X POST http://localhost:3000/auth/login \
  -H "Content-Type: application/json" \
  -d '{"email": "example@example.com", "password": "password123"}'
  ```

- **إضافة فرع جديد**:

  ```bash
  curl -X POST http://localhost:3000/branches \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer <your-token>" \
  -d '{"name": "Main Branch", "location": "Downtown"}'
  ```

### 4. ملاحظات إضافية

- تأكد من تشغيل قاعدة البيانات قبل تشغيل الخادم.
- قم بمراجعة ملف `API_Documentation.md` للحصول على تفاصيل إضافية حول نقاط النهاية.

---

## توثيق واجهات المصادقة (Auth APIs)

### 1. إنشاء مستخدم جديد (أي نوع)

- **المسار:** `/users`
- **الطريقة:** POST
- **الوصف:** إنشاء مستخدم جديد من أي نوع (SUPER_ADMIN, ADMIN_STAFF, GYM_OWNER, RECEPTIONIST, TRAINER, MEMBER)
- **البيانات المطلوبة:**

  ```json
  {
    "name": "اسم المستخدم",
    "email": "user@example.com",
    "password": "password123",
    "type": "ADMIN_STAFF" // أو أي نوع آخر: SUPER_ADMIN, GYM_OWNER, RECEPTIONIST, TRAINER, MEMBER
  }
  ```

- **ملاحظة:**
  - لإنشاء SUPER_ADMIN غالبًا يجب أن يكون لديك صلاحيات خاصة أو تستخدم Seeder.
  - لإنشاء ADMIN_STAFF أو أي نوع آخر، يجب أن يكون لديك صلاحيات مناسبة (مثلاً SUPER_ADMIN أو ADMIN_STAFF).

- **الاستجابة الناجحة:**

  ```json
  {
    "id": 1,
    "name": "اسم المستخدم",
    "email": "user@example.com",
    "type": "ADMIN_STAFF"
  }
  ```

### 2. تسجيل الدخول

- **المسار:** `/auth/login`
- **الطريقة:** POST
- **الوصف:** تسجيل الدخول لأي مستخدم (بغض النظر عن النوع)
- **البيانات المطلوبة:**

  ```json
  {
    "email": "user@example.com",
    "password": "password123"
  }
  ```

- **الاستجابة الناجحة:**

  ```json
  {
    "token": "jwt-token"
  }
  ```

### 3. ملاحظات هامة
- يجب إرسال رمز المصادقة (JWT Token) في ترويسة الطلبات (Authorization Header) للوصول إلى أغلب نقاط النهاية الإدارية.
- أنواع المستخدمين المتاحة:
  - SUPER_ADMIN
  - ADMIN_STAFF
  - GYM_OWNER
  - RECEPTIONIST
  - TRAINER
  - MEMBER
- كل نوع له صلاحيات مختلفة حسب النظام.

---

## ملاحظات

- تأكد من إرسال رمز المصادقة (JWT Token) في ترويسة الطلبات (Headers) عند الحاجة.

- جميع البيانات يجب أن تكون بصيغة JSON.

---

## استفسارات

لأي استفسارات إضافية، يرجى التواصل مع فريق الدعم الفني.
